{%extends "main.njk"%}
{%set public_routes = 'public_routes'|getParam%}
{%block head%}
<link rel="stylesheet" href="../client/style/layout.css?{{cacheBuster}}">
{%include "_style.njk"%}
{%endblock%}
{%block body%}
{%set public_routes = 'public_routes'|getParam%}
<section>
    <article>
        <div class="preview">
            <iframe width="1920" height="1080" src="{{public_routes.PANEL_EMBED}}#edit"></iframe>
        </div>
        <div class="layers">
<!--            <label for="&#45;&#45;_feat-layer" >-->
<!--                <input type="radio" value="&#45;&#45;_feat" id="&#45;&#45;_feat-layer" name="layers" checked/>-->
<!--                <div aria-label="FEAT"></div>-->
<!--            </label>-->
<!--            <label for="&#45;&#45;_bpm-layer">-->
<!--                <input type="radio" value="&#45;&#45;_bpm" id="&#45;&#45;_bpm-layer" name="layers"/>-->
<!--                <div aria-label="BPM"></div>-->
<!--            </label>-->
<!--            <label for="&#45;&#45;_draw-layer">-->
<!--                <input type="radio" value="&#45;&#45;_draw" id="&#45;&#45;_draw-layer" name="layers"/>-->
<!--                <div aria-label="DRAW"></div>-->
<!--            </label>-->
<!--            <label for="&#45;&#45;_med-layer">-->
<!--                <input type="radio" value="&#45;&#45;_med" id="&#45;&#45;_med-layer" name="layers"/>-->
<!--                <div aria-label="MEDIA"></div>-->
<!--            </label>-->
            <label for="o" aria-label="FEAT"><input type="radio" name="mode" id="o" checked hidden/></label>
            <label for="t" aria-label="BPM"><input type="radio" name="mode" id="t" hidden/></label>
            <label for="s" aria-label="DRAW"><input type="radio" name="mode" id="s" hidden/></label>
            <label for="r" aria-label="SPIN"><input type="radio" name="mode" id="r" hidden/></label>
        </div>
        <div class="modes">
            <label for="o" aria-label="FADE"><input type="radio" name="mode" id="o" checked hidden/></label>
            <label for="t" aria-label="MOVE"><input type="radio" name="mode" id="t" hidden/></label>
            <label for="s" aria-label="SIZE"><input type="radio" name="mode" id="s" hidden/></label>
            <label for="r" aria-label="SPIN"><input type="radio" name="mode" id="r" hidden/></label>
        </div>
        <div class="controls">
            <label>
                <input type="range" min="0" max="200" step="5.0" value="50" name="--_feat-tX" hidden/>
                <input type="range" min="0" max="200" step="5.0" value="50" name="--_feat-tY" hidden/>
            </label>
        </div>
    </article>
</section>
{%include "_home.njk"%}
{%endblock%}
{%block dialogs%}
{%set device_ip = "device_ip"|getParam%}
<dialog id="qr-dialog">
    <h2 aria-label="Embed Link"></h2>
    <h3 aria-label="Use this link as a source input"></h3>
    <canvas data-url="https://{{device_ip}}{{public_routes.PANEL_EMBED}}"></canvas>
    <button data-url="https://{{device_ip}}{{public_routes.PANEL_EMBED}}" aria-label="Click to Copy Link!" data-click-text="Link Copied!"></button>
    <button aria-label="âœ…Done" onclick="javascript:document.body.querySelector('#qr-dialog').close();"></button>
</dialog>
{%endblock%}
{%block scripts%}
<script defer>
    document.addEventListener("DOMContentLoaded", () => cssDevWatch());
    document.addEventListener("DOMContentLoaded", () => reducedMotion());
    document.addEventListener("DOMContentLoaded", () => iframeDetect());
    document.addEventListener("DOMContentLoaded", () => socketConnect());
    document.addEventListener("DOMContentLoaded", () => socketWatchReload());
    document.addEventListener("DOMContentLoaded", () => scrollSnap(document.body.querySelector("body > section")));
    document.addEventListener("DOMContentLoaded", () => generateCopyLink(document.body.querySelector("#qr-dialog button[data-url]")));
    document.addEventListener("DOMContentLoaded", () => generateQrCode(
        document.body.querySelector("#qr-dialog canvas"),
        document.body.querySelector("#qr-dialog canvas").getAttribute("data-url"),
    ));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.preview', 'width', '--js-module-preview-width'));
    document.addEventListener("DOMContentLoaded", () => applyLayoutStyles());
    document.addEventListener("DOMContentLoaded", () => initializeLayoutClickTouch());
    // document.addEventListener("DOMContentLoaded", () => enableLayerDragDrop());
</script>
{%endblock%}