<!DOCTYPE html>
<html lang="en">
<head>
    <title>Draw</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="keyword">
    <link rel="icon" href="/icon512_rounded.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js?" defer type="text/javascript" crossorigin="anonymous"></script>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js?" defer type="text/javascript" crossorigin="anonymous"></script>
    <script src="../client/script/css_dev_watch.js?" defer type="text/javascript"></script>
    <script src="../client/script/iframe_detect.js?" defer type="text/javascript"></script>
    <script src="../client/script/edit_detect.js?" defer type="text/javascript"></script>
    <script src="../client/script/socket.js?" defer type="text/javascript"></script>
    <script src="../client/script/get_path.js?" defer type="text/javascript"></script>
    <link href="../client/style/variables.css?" rel="stylesheet">
    <link href="../client/style/reset.css?" rel="stylesheet">
    <link href="../client/style/base.css?" rel="stylesheet">
    <link href="../client/style/iframe.css?" rel="stylesheet">
    <meta name="INDEX" content="index.html">
    <meta name="PANEL_DASHBOARD" content="panel-dashboard.html">
    <meta name="PANEL_ACTIONS" content="panel-actions.html">
    <meta name="PANEL_LAYOUT" content="panel-layout.html">
    <meta name="PANEL_DRAW" content="panel-draw.html">
    <meta name="PANEL_EMBED" content="embed.html">
    <meta name="PANEL_FEATURE_EMBED" content="embed-feature.html">
    <meta name="PANEL_MEDIA_EMBED" content="embed-media.html">
    <meta name="PANEL_DRAW_EMBED" content="embed-draw.html">
    <meta name="PANEL_SOUND_EMBED" content="embed-sound.html">
    <meta name="API_STYLE_GET" content="https://api.dbdbdbdbdbgroup.com/demo/api/style/get">
    <meta name="API_CONFIG_GET" content="https://api.dbdbdbdbdbgroup.com/demo/api/config/get">
    <meta name="API_SIGNAL_CREATE" content="https://api.dbdbdbdbdbgroup.com/demo/api/signal/create">
    <meta name="API_CONFIG_UPDATE" content="https://api.dbdbdbdbdbgroup.com/demo/api/config/update">
    <meta name="API_STYLE_UPDATE" content="https://api.dbdbdbdbdbgroup.com/demo/api/style/update">
    <meta name="API_MEDIA_UPDATE" content="https://api.dbdbdbdbdbgroup.com/demo/api/media/update">
    <meta name="TWITCH_LOGIN" content="https://api.dbdbdbdbdbgroup.com/demo/t/w/i/t/c/h/l/o/g/i/n/">
    <meta name="TWITCH_LOGIN_SUCCESS" content="https://api.dbdbdbdbdbgroup.com/t/w/i/t/c/h/l/o/g/i/n/s/u/c/c/e/s/s/">
    <style>
        #embed {
            width: 100vw;
            height: 100vh;
            object-fit: contain;
            background: none;
        }
    </style>
    <style>
        :root {
            --_draw-o: 100.0;
            --_draw-tX: 50.0;
            --_draw-tY: 50.0;
            --_draw-sX: 50.0;
            --_draw-sY: 50.0;
            --_draw-rX: 50.0;
            --_draw-rY: 50.0;
        }
    </style>
    <style id="public_module_styles"></style>
    <style>
        html.edit #embed {
            box-shadow: inset 0 0 25px 25px #000;
            background-color: #dbdbdb;
            opacity: 0.8;
            background-image: linear-gradient(-45deg, #dbdbdb, #dbdbdb 50%, #ffffff 50%, #ffffff);
            background-size: 23px 23px;
        }

        main {
            perspective: calc(1 * 1920px);
            transform: translateX(calc(calc(var(--_draw-tX) * -1%) + 50%)) translateY(calc(calc(var(--_draw-tY) * -1%) + 50%));
        }

        #embed {
            box-sizing: border-box;
            object-fit: scale-down;
            opacity: calc(var(--_draw-o) / 100);
            transform: scaleX(calc(calc(var(--_draw-sX) * 0.01) + 0.0)) scaleY(calc(calc(var(--_draw-sY) * 0.01) + 0.0)) rotateX(calc(calc(var(--_draw-rY) * 1.8deg) - 90deg)) rotateY(calc(calc(var(--_draw-rX) * -1.8deg) - 90deg)) rotateZ(0deg) scaleX(-1);
        }
    </style>
</head>
<body>
<main>
    <canvas id="embed"></canvas>
</main>
<script>
    document.addEventListener("DOMContentLoaded", () => cssDevWatch());
    document.addEventListener("DOMContentLoaded", () => iframeDetect());
    document.addEventListener("DOMContentLoaded", () => editDetect());
    document.addEventListener("DOMContentLoaded", () => socketConnect());
    document.addEventListener("DOMContentLoaded", () => socketWatchReload());
    document.addEventListener("DOMContentLoaded", () => {
        const processStyle = (style) => {
            document.head.querySelector('#public_module_styles').innerHTML = `:root{${style};}`;
            console.log(`processStyle :: set ${style}`);
        };
        const res = axios.get(getPath("API_STYLE_GET"));
        res.then((res) => processStyle(res.data));
        res.catch((error) => console.log("API_STYLE_GET :: error:", error.response.data));
        res.finally(_ => console.info("API_STYLE_GET :: complete"));
    });
    document.addEventListener("DOMContentLoaded", () => socketWatchStyle((payload) => {
        let style = payload.split('style:set:')[1];
        document.head.querySelector('#public_module_styles').innerHTML = `:root{${style};}`;
        console.log(`socketWatchStyle :: draw :: set ${style}`);
    }));
    document.addEventListener("DOMContentLoaded", () => {
        const updateCanvas = () => {
            const canvas = document.querySelector("canvas");
            canvas.width = document.body.getBoundingClientRect().width;
            canvas.height = document.body.getBoundingClientRect().height;
            canvas.style.width = `${canvas.width}px`;
            canvas.style.height = `${canvas.height}px`;
        };
        window.addEventListener('resize', updateCanvas);
        updateCanvas();
    });
    document.addEventListener("DOMContentLoaded", () => {
        document.$drawPayload = (payload) => {
            if (document.$drawing) {
                console.log('socketWatchDrawSet busy...');
                return;
            }
            document.$drawing = true;
            const pixelSize = 20;
            let playback = payload.split(":")[1].split(",");
            const replay = [...playback];
            const canvas = document.querySelector("canvas");
            const ctx = document.querySelector("canvas").getContext("2d");
            document.replayDone = () => {
                setTimeout(() => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    document.$drawing = false;
                    if ('#edit' === window.location.hash) {
                        playback = [...replay];
                        document.replayStart();
                    }
                }, 5000)
            };
            document.replayStart = () => {
                if (playback.length) {
                    const x = canvas.width * Number(playback.shift());
                    const y = canvas.height * Number(playback.shift());
                    if (document.$pXY) {
                        const [lastX, lastY] = document.$pXY;
                        if (Math.abs(lastX - x) < 100) {
                            const steps = 10;
                            for (let i = 1; i <= steps; i++) {
                                const interpX = lastX + (x - lastX) * (i / steps);
                                const interpY = lastY + (y - lastY) * (i / steps);
                                ctx.beginPath();
                                ctx.arc(interpX, interpY, (pixelSize * 1.25) / 2, 0, Math.PI * 2, false);
                                ctx.fill();
                            }
                        }
                    }
                    ctx.fillStyle = "#2fffa5";
                    ctx.beginPath();
                    ctx.arc(x, y, (pixelSize * 1.25) / 2, 0, Math.PI * 2, false);
                    ctx.fill();
                    document.$pXY = [x, y];
                    requestAnimationFrame(document.replayStart);
                } else {
                    document.replayDone();
                }
            };
            document.replayStart();
        }
    });
    document.addEventListener("DOMContentLoaded", () => socketWatchDrawSet((payload) => {
        if ('#edit' === window.location.hash) {
            return;
        }
        document.$drawPayload(payload);
    }));
    document.addEventListener("DOMContentLoaded", () => {
        if ('#edit' === window.location.hash) {
            const payload = "draw:0.060,0.483,0.068,0.463,0.069,0.460,0.070,0.455,0.072,0.450,0.073,0.445,0.074,0.440,0.077,0.435,0.080,0.427,0.081,0.422,0.083,0.417,0.087,0.410,0.090,0.402,0.093,0.397,0.096,0 .389,0.100,0.382,0.106,0.374,0.109,0.364,0.115,0.356,0.119,0.349,0.126,0.336,0.132,0.326,0.138,0.316,0.145,0.305,0.151,0.295,0.159,0.285,0.166,0.277,0.172,0.267,0.179,0.260,0.188,0.252,0.194,0.244,0.201,0.239,0.207,0.234,0.212,0.232 ,0.219,0.229,0.224,0.227,0.228,0.224,0.233,0.222,0.237,0.222,0.241,0.222,0.244,0.222,0.246,0.222,0.248,0.222,0.249,0.222,0.249,0.224,0.250,0.227,0.250,0.229,0.252,0.232,0.252,0.237,0.252,0.242,0.252,0.247,0.252,0.252,0.252,0.257,0.2 50,0.265,0.249,0.272,0.248,0.280,0.246,0.285,0.244,0.293,0.241,0.300,0.240,0.308,0.237,0.316,0.235,0.323,0.232,0.328,0.229,0.336,0.227,0.343,0.224,0.349,0.222,0.356,0.219,0.361,0.215,0.369,0.212,0.374,0.210,0.382,0.206,0.389,0.205,0 .397,0.201,0.402,0.198,0.410,0.196,0.415,0.193,0.422,0.190,0.427,0.188,0.435,0.186,0.440,0.182,0.448,0.180,0.455,0.179,0.460,0.176,0.468,0.175,0.473,0.172,0.481,0.171,0.486,0.169,0.491,0.168,0.498,0.166,0.509,0.166,0.516,0.164,0.521 ,0.164,0.529,0.164,0.534,0.163,0.542,0.163,0.549,0.163,0.557,0.163,0.564,0.163,0.572,0.163,0.580,0.164,0.587,0.164,0.592,0.166,0.600,0.168,0.605,0.169,0.613,0.171,0.618,0.173,0.623,0.176,0.628,0.177,0.633,0.180,0.638,0.182,0.643,0.1 86,0.646,0.189,0.651,0.192,0.653,0.196,0.656,0.199,0.658,0.203,0.661,0.207,0.661,0.211,0.661,0.216,0.663,0.222,0.663,0.228,0.663,0.235,0.661,0.240,0.658,0.246,0.656,0.255,0.653,0.262,0.648,0.270,0.643,0.276,0.641,0.284,0.636,0.289,0 .630,0.296,0.623,0.302,0.615,0.308,0.610,0.317,0.600,0.322,0.592,0.327,0.585,0.332,0.577,0.336,0.572,0.341,0.562,0.347,0.554,0.352,0.544,0.357,0.537,0.362,0.526,0.368,0.516,0.373,0.506,0.378,0.493,0.383,0.486,0.388,0.476,0.394,0.465 ,0.399,0.455,0.405,0.445,0.411,0.435,0.416,0.425,0.421,0.415,0.428,0.402,0.433,0.392,0.438,0.382,0.443,0.371,0.447,0.361,0.451,0.354,0.455,0.343,0.459,0.336,0.463,0.328,0.465,0.323,0.469,0.318,0.473,0.310,0.476,0.305,0.480,0.300,0.4 82,0.295,0.486,0.293,0.489,0.288,0.491,0.285,0.494,0.283,0.497,0.280,0.499,0.277,0.502,0.275,0.504,0.272,0.508,0.272,0.512,0.270,0.516,0.270,0.519,0.267,0.523,0.267,0.529,0.265,0.533,0.265,0.537,0.265,0.540,0.262,0.543,0.262,0.547,0 .262,0.550,0.262,0.551,0.262,0.551,0.265,0.553,0.267,0.554,0.270,0.555,0.272,0.555,0.275,0.557,0.280,0.557,0.285,0.557,0.293,0.558,0.300,0.558,0.308,0.558,0.321,0.558,0.331,0.558,0.341,0.558,0.349,0.557,0.359,0.555,0.366,0.554,0.377 ,0.553,0.384,0.551,0.392,0.550,0.399,0.549,0.407,0.547,0.412,0.546,0.420,0.543,0.427,0.542,0.435,0.541,0.443,0.538,0.450,0.537,0.455,0.534,0.463,0.532,0.470,0.530,0.476,0.529,0.483,0.527,0.488,0.525,0.496,0.523,0.503,0.521,0.509,0.5 20,0.514,0.517,0.521,0.516,0.526,0.515,0.531,0.512,0.537,0.511,0.544,0.510,0.549,0.508,0.557,0.507,0.564,0.506,0.570,0.504,0.577,0.503,0.585,0.502,0.592,0.500,0.600,0.499,0.608,0.498,0.618,0.497,0.625,0.495,0.633,0.494,0.641,0.493,0 .651,0.493,0.658,0.493,0.666,0.491,0.674,0.491,0.679,0.491,0.686,0.491,0.694,0.491,0.702,0.491,0.707,0.491,0.714,0.491,0.724,0.493,0.732,0.494,0.737,0.497,0.745,0.498,0.750,0.499,0.757,0.502,0.763,0.504,0.768,0.508,0.773,0.512,0.778 ,0.516,0.783,0.520,0.788,0.524,0.793,0.528,0.796,0.533,0.801,0.537,0.803,0.542,0.806,0.547,0.808,0.551,0.808,0.558,0.811,0.563,0.811,0.567,0.811,0.571,0.811,0.575,0.811,0.579,0.808,0.583,0.808,0.585,0.806,0.588,0.801,0.592,0.796,0.5 94,0.790,0.598,0.785,0.602,0.778,0.606,0.770,0.609,0.760,0.613,0.752,0.615,0.745,0.619,0.737,0.622,0.730,0.624,0.722,0.627,0.712,0.630,0.704,0.633,0.694,0.636,0.686,0.639,0.676,0.641,0.666,0.644,0.656,0.648,0.646,0.650,0.636,0.654,0 .623,0.657,0.613,0.659,0.603,0.662,0.592,0.665,0.585,0.667,0.575,0.671,0.562,0.674,0.552,0.676,0.539,0.680,0.524,0.684,0.511,0.688,0.498,0.691,0.488,0.693,0.478,0.697,0.468,0.700,0.458,0.704,0.448,0.706,0.437,0.710,0.427,0.713,0.415 ,0.717,0.404,0.721,0.394,0.723,0.387,0.729,0.374,0.734,0.364,0.738,0.354,0.742,0.343,0.747,0.336,0.751,0.328,0.755,0.321,0.759,0.316,0.762,0.310,0.765,0.308,0.768,0.305,0.770,0.303,0.773,0.303,0.775,0.303,0.777,0.303,0.779,0.303,0.7 81,0.303,0.783,0.303,0.785,0.305,0.787,0.308,0.789,0.310,0.791,0.316,0.794,0.323,0.795,0.328,0.798,0.336,0.799,0.343,0.800,0.351,0.802,0.359,0.803,0.366,0.803,0.374,0.804,0.384,0.804,0.394,0.804,0.404,0.804,0.412,0.804,0.422,0.804,0 .430,0.803,0.437,0.802,0.448,0.800,0.455,0.800,0.463,0.799,0.473,0.798,0.481,0.796,0.488,0.795,0.496,0.795,0.503,0.792,0.511,0.791,0.519,0.790,0.526,0.789,0.531,0.787,0.539,0.785,0.547,0.783,0.554,0.782,0.559,0.781,0.564,0.779,0.572 ,0.778,0.577,0.777,0.582,0.775,0.587,0.774,0.592,0.773,0.597,0.772,0.603,0.770,0.610,0.769,0.615,0.768,0.620,0.766,0.628,0.765,0.633,0.764,0.638,0.764,0.643,0.762,0.648,0.761,0.656,0.760,0.661,0.760,0.669,0.760,0.676,0.759,0.681,0.7 59,0.686,0.759,0.694,0.759,0.702,0.759,0.707,0.759,0.712,0.760,0.719,0.760,0.724,0.761,0.730,0.762,0.735,0.765,0.737,0.766,0.742,0.769,0.750,0.772,0.755,0.774,0.757,0.778,0.765,0.782,0.770,0.786,0.775,0.790,0.780,0.794,0.785,0.798,0 .788,0.802,0.790,0.804,0.793,0.808,0.796,0.812,0.796,0.816,0.798,0.820,0.801,0.824,0.801,0.826,0.803,0.829,0.803,0.832,0.803,0.834,0.803,0.837,0.803,0.839,0.803,0.842,0.801,0.845,0.798,0.846,0.796,0.848,0.793,0.850,0.790,0.852,0.788 ,0.855,0.783,0.858,0.778,0.860,0.773,0.862,0.768,0.864,0.763,0.865,0.757,0.867,0.752,0.869,0.745,0.871,0.740,0.871,0.735,0.872,0.730,0.872,0.724,0.873,0.719,0.873,0.714,0.875,0.709,0.875,0.702,0.876,0.697,0.876,0.689,0.876,0.684,0.8 77,0.676,0.878,0.669,0.878,0.663,0.880,0.658,0.880,0.653,0.881,0.648,0.882,0.643,0.884,0.638,0.885,0.633,0.886,0.628,0.889,0.623,0.890,0.620,0.891,0.618,0.893,0.615,0.893,0.613,0.895,0.610,0.897,0.610,0.897,0.608,0.899,0.608,0.901,0 .608,0.902,0.605,0.903,0.605,0.905,0.605,0.906,0.605,0.907,0.605,0.908,0.608,0.910,0.610,0.911,0.610,0.912,0.615,0.914,0.618,0.915,0.620,0.918,0.623,0.918,0.625,0.919,0.628,0.920,0.630,0.921,0.630,0.921,0.636,0.923,0.638,0.924,0.641 ,0.925,0.643,0.925,0.646,0.927,0.648,0.927,0.651,0.928,0.651,0.928,0.656,0.928,0.658,0.928,0.661,0.929,0.663,0.929,0.666,0.931,0.669";
            document.$drawPayload(payload);
        }
    });
</script>
</body>
</html>