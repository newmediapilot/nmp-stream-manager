{%extends "main.njk"%}
{%set public_routes = 'public_routes'|getParam%}
{%block head%}
<link rel="stylesheet" href="../client/style/modules.css?{{cacheBuster}}">
{%include "_style.njk"%}
{%endblock%}
{%block body%}
{%set public_routes = 'public_routes'|getParam%}
<section class="modules">
    <article class="module aqua">
        <div class="title" aria-label="Featured">
            <button onclick="javascript:document.body.querySelector('#qr-dashboard-dialog').showModal()"
                    aria-label="ðŸ”—"></button>
        </div>
        <div class="preview">
            <iframe width="1920"
                    height="1080"
                    src="{{public_routes.PANEL_FEATURE_EMBED}}#edit">
            </iframe>
        </div>
        <div class="controls">
            <label data-aria-label="move">
                <input type="range" min="0" max="100" step="5" value="0" name="--_feat-translateX">
                <input type="range" min="0" max="100" step="5" value="0" name="--_feat-translateY" hidden>
            </label>
            <label data-aria-label="size">
                <input type="range" min="20" max="100" step="5" value="5" name="--_feat-scaleX">
                <input type="range" min="20" max="100" step="5" value="5" name="--_feat-scaleX" hidden>
            </label>
            <label data-aria-label="tilt">
                <input type="range" min="-25" max="25" step="5" value="0" name="--_feat-rotateY">
                <input type="range" min="-25" max="25" step="5" value="0" name="--_feat-rotateX"hidden>
            </label>
            <label data-aria-label="turn">
                <input type="range" min="0" max="75" step="5" value="0" name="--_feat-rotateZ">
                <input type="range" min="0" max="75" step="5" value="0" name="--_feat-rotateZ" hidden>
            </label>
        </div>
    </article>
    <article class="module bloodorange">
        <div class="title" aria-label="BPM">
            <button onclick="javascript:document.body.querySelector('#qr-dashboard-dialog').showModal()"
                    aria-label="ðŸ”—"></button>
        </div>
        <div class="preview">
            <iframe width="1920"
                    height="1080"
                    src="{{public_routes.PANEL_BPM_EMBED}}#edit">
            </iframe>
        </div>
        <div class="controls">
            <label data-aria-label="move">
                <input type="range" min="0" max="100" step="5" value="0" name="--_bmp-translateX">
                <input type="range" min="0" max="100" step="5" value="0" name="--_bmp-translateY" hidden>
            </label>
            <label data-aria-label="size">
                <input type="range" min="20" max="100" step="5" value="5" name="--_bmp-scaleX">
                <input type="range" min="20" max="100" step="5" value="5" name="--_bmp-scaleX" hidden>
            </label>
            <label data-aria-label="tilt">
                <input type="range" min="-25" max="25" step="5" value="0" name="--_bmp-rotateY">
                <input type="range" min="-25" max="25" step="5" value="0" name="--_bmp-rotateX"hidden>
            </label>
            <label data-aria-label="turn">
                <input type="range" min="0" max="75" step="5" value="0" name="--_bmp-rotateZ">
                <input type="range" min="0" max="75" step="5" value="0" name="--_bmp-rotateZ" hidden>
            </label>
        </div>
    </article>
</section>
{%include "_home.njk"%}
{%endblock%}
{%block dialogs%}
{%set device_ip = "device_ip"|getParam%}
<dialog id="qr-dashboard-dialog" data-url="https://{{device_ip}}">
    <section>
        <h2 aria-label="QR Code Link"></h2>
        <h3 aria-label="This link will open this page on any device on your network"></h3>
        <canvas></canvas>
        <button aria-label="Click to Copy Link!"></button>
        <button aria-label="âœ…Done"
                onclick="javascript:document.body.querySelector('#qr-dashboard-dialog').close();"></button>
    </section>
</dialog>
{%endblock%}
{%block scripts%}
<script defer>
    document.addEventListener("DOMContentLoaded", () => reducedMotion());
    document.addEventListener("DOMContentLoaded", () => cssDevWatch());
    document.addEventListener("DOMContentLoaded", () => iframeDetect());
    document.addEventListener("DOMContentLoaded", () => socketConnect());
    document.addEventListener("DOMContentLoaded", () => socketWatchReload());
    document.addEventListener("DOMContentLoaded", () => scrollSnap(document.body.querySelector("body > section")));
    document.addEventListener("DOMContentLoaded", () => generateCopyLink(document.body.querySelector("#qr-dashboard-dialog")));
    document.addEventListener("DOMContentLoaded", () => generateQrCode(
        document.body.querySelector("#qr-dashboard-dialog canvas"),
        document.body.querySelector("#qr-dashboard-dialog").getAttribute("data-url"),
    ));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.preview', 'width', '--js-module-preview-width'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.title', 'height', '--js-module-title-height', 'px'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.module', 'height', '--js-module-content-height', 'px'));
    document.addEventListener("DOMContentLoaded", () => applyModuleStyles());
    document.addEventListener("DOMContentLoaded", () => initializeModuleClickTouch());
</script>
{%endblock%}