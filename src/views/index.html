<!-- src/views/index.html -->
{% extends "layouts/main.njk" %}
{% set public_routes = 'public_routes' | getParam %}
{% block cdn %}<!-- noscript -->{% endblock %}
{% block local %}<!-- style -->{% endblock %}
{% block hscripts %}
<style>

    html {
        background: url("/image/assets-from-space.webp");
    }

    html,
    body {
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        overflow-y: hidden;
    }


    .pages {

        --grid-cell-width: 70vw;
        --grid-cell-height: var(--grid-cell-width);

        overflow-x: hidden;
        overflow-y: hidden;
        position: relative;
        margin: 0;
        padding: 0;
        background: repeating-linear-gradient(-45deg, #020202, #131313 15px);

        display: grid;
        grid-template-columns: repeat(3, var(--grid-cell-width));
        grid-template-rows: repeat(3, var(--grid-cell-height));
        grid-gap: 0;

        width: calc(var(--grid-cell-width) * 3);
        height: calc(var(--grid-cell-height) * 3);

        --initiali-translate-xy: calc(var(--grid-cell-width) * -1);
        transform: translateX(var(--initiali-translate-xy)) translateY(var(--initiali-translate-xy));
    }

    .pages > * {
        border: none;
        width: 100%;
        height: 100%;
    }

    .pages iframe:nth-child(1) {
        grid-row: 1;
        grid-column: 1;
    }

    .pages iframe:nth-child(2) {
        grid-row: 1;
        grid-column: 2;
    }

    .pages iframe:nth-child(3) {
        grid-row: 1;
        grid-column: 3;
    }

    .pages iframe:nth-child(4) {
        grid-row: 2;
        grid-column: 1;
    }

    .pages iframe:nth-child(5) {
        grid-row: 2;
        grid-column: 2;
    }

    .pages iframe:nth-child(6) {
        grid-row: 2;
        grid-column: 3;
    }

    .pages iframe:nth-child(7) {
        grid-row: 3;
        grid-column: 1;
    }

    .pages iframe:nth-child(8) {
        grid-row: 3;
        grid-column: 2;
    }

    .pages iframe:nth-child(9) {
        grid-row: 3;
        grid-column: 3;
    }

</style>
{% endblock %}
{% block body %}
<div class="pages">
    <iframe></iframe>
    <iframe></iframe>
    <iframe></iframe>
    <iframe src="{{public_routes.PUBLIC_SETTINGS}}"></iframe>
    <iframe src="{{public_routes.PUBLIC_DASHBOARD}}"></iframe>
    <iframe src="{{public_routes.PUBLIC_MODULES}}"></iframe>
    <iframe></iframe>
    <iframe></iframe>
    <iframe></iframe>
</div>
{% endblock %}
{% block fscripts %}
<script defer crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" defer
        type="text/javascript"></script>
<script defer crossorigin="anonymous" src="https://cdn.socket.io/4.0.0/socket.io.min.js" defer
        type="text/javascript"></script>
<script defer crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" defer
        type="text/javascript"></script>
<script defer src="/script/socket_connect.js?={{cache_buster}}" type="text/javascript"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        window.addEventListener('message', function (e) {
            const path = e.data.message
            if (e.origin === window.location.origin && e.data.type === "path") {;
                const iframeEls = Array.from(document.querySelectorAll("iframe"));
                const iframeEl = iframeEls.find(el => {
                    return el.getAttribute('src') === path.trim();
                });
                console.log('iframeEl', iframeEl);
            }
        });
    });
</script>
{% endblock %}