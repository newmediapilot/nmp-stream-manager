{% extends "layouts/main.njk" %}
{% set cache_buster = "" | currentTime %}
{% set public_routes = 'public_routes' | getParam %}
{% block hscripts %}
<link rel="stylesheet" href="/style/modules.css?cb={{cache_buster}}">
{% from "macros/public_module_styles.njk" import public_module_styles %}
{{ public_module_styles() }}
{% endblock %}
{% block body %}
{% set public_routes = 'public_routes' | getParam %}
<div class="modules">
    <div class="module aqua">
        <div class="title">
            <p>FEATURE</p>
            <button onclick="javascript:showPanelQR('#feature_embed_qrcode_dialog', 'FEATURE')">ðŸ”—</button>
        </div>
        <div class="preview">
            <iframe width="1920" height="1080"
                    src="{{public_routes.PUBLIC_FEATURE_EMBED}}?featuredName=0#featuredNameLock"></iframe>
        </div>
        <div class="controls">
            <label aria-label="size">
                <input type="range" min="75" max="100" step="1" value="100" name="--_feat-scaleX">
                <input type="range" min="75" max="100" step="1" value="100" name="--_feat-scaleY" hidden>
            </label>
            <label aria-label="move">
                <input type="range" min="0" max="100" step="1" value="0" name="--_feat-translateX">
                <input type="range" min="0" max="100" step="1" value="0" name="--_feat-translateY" hidden>
            </label>
            <label aria-label="spin">
                <input type="range" min="-10" max="10" step="1" value="0" name="--_feat-rotateX">
                <input type="range" min="-10" max="10" step="1" value="0" name="--_feat-rotateY" hidden>
            </label>
        </div>
    </div>
    <div class="module bloodorange">
        <div class="title">
            <p>BPM</p>
            <button onclick="javascript:showPanelQR('#feature_embed_qrcode_dialog', 'BPM')">ðŸ”—</button>
        </div>
        <div class="preview">
            <iframe width="1920" height="1080"
                    src="{{public_routes.PUBLIC_BPM_EMBED}}"></iframe>
        </div>
        <div class="controls">
            <label aria-label="size">
                <input type="range" min="80" max="100" step="1" value="100" name="--_bpm-scaleX">
                <input type="range" min="80" max="100" step="1" value="100" name="--_bpm-scaleY" hidden>
            </label>
            <label aria-label="move">
                <input type="range" min="0" max="10" step="1" value="0" name="--_bpm-translateX">
                <input type="range" min="0" max="10" step="1" value="0" name="--_bpm-translateY" hidden>
            </label>
            <label aria-label="spin">
                <input type="range" min="-10" max="10" step="1" value="0" name="--_bpm-rotateX">
                <input type="range" min="-10" max="10" step="1" value="0" name="--_bpm-rotateY" hidden>
            </label>
        </div>
    </div>
</div>
{% include "partials/controls.njk" %}
{% endblock %}
{% block extras %}
<!-- dialogs start -->
<!--<dialog class="dialog-container" id="{{ id }}">-->
<!--    <div class="dialog&#45;&#45;title">...</div>-->
<!--    <div class="dialog&#45;&#45;body">...</div>-->
<!--    <canvas id="qr-code-dialog-canvas" data-url="https://{{ device_ip  }}{{ public_route }}"></canvas>-->
<!--    <button style="background: deepskyblue" id="qr-code-copy-link"-->
<!--            data-clipboard-text="https://{{ device_ip  }}{{ public_route }}">Click to Copy Link!-->
<!--    </button>-->
<!--    <button style="background: green" onclick="javascript:hideDialog('{{ id }}')">âœ…Done</button>-->
<!--</dialog>-->
<!-- dialogs end -->
{% endblock %}
{% block fscripts %}
<script defer>
    document.addEventListener("DOMContentLoaded", () => iframeDetect());
    // document.addEventListener("DOMContentLoaded", () => socketConnect());
    // document.addEventListener("DOMContentLoaded", () => socketWatchReload());
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.preview', 'width', '--js-module-preview-width'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.title', 'height', '--js-module-title-height', 'px'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.module', 'height', '--js-module-content-height', 'px'));
    // document.addEventListener("DOMContentLoaded", () => applyStyleUpdates());
    // document.addEventListener("DOMContentLoaded", () => initializeInputForms());
    document.addEventListener("DOMContentLoaded", () => scrollSnap(document.querySelector(".modules")));
</script>
{% endblock %}