<!-- src/views/dashboard.html -->
{% extends "layouts/main.njk" %}
{% from "macros/public_module_styles.njk" import public_module_styles %}
{% from "macros/qrcode_dialog.njk" import qrcode_dialog %}
{% set cache_buster = "" | currentTime %}
{% set public_routes = 'public_routes' | getParam %}
{% block hscripts %}
<link rel="stylesheet" href="/style/modules.css?cb={{cache_buster}}">
{% endblock %}
{% block body %}
{% include "partials/controls.njk" %}
<style>
</style>
{% set public_routes = 'public_routes' | getParam %}
{{ public_module_styles() }}
<div class="modules">

    <!--FEATURE-->
    <!--FEATURE-->
    <!--FEATURE-->
    <div class="module aqua">
        <div class="title">
            <p>Featured</p>
            <button onclick="javascript:showPanelQR('#feature_embed_qrcode_dialog', 'Featured')">ðŸ”—</button>
        </div>
        <div class="preview">
            <iframe width="1920" height="1080" src="{{public_routes.PUBLIC_FEATURE_EMBED}}"></iframe>
        </div>
        <div class="controls">
            <div class="module-9x9-selector">
                <ul>
                    {% for r1 in [1, 2, 3] %}{% for c1 in [1, 2, 3] %}
                    <li>
                        <input onclick="javascript:pushStyleUpdates()" type="radio" name="group3"
                               value="--feature-grid-column-start:{{ c1 }}; --feature-grid-column-end:{{ c1 + 1 }};--feature-grid-row-start:{{ r1 }}; --feature-grid-row-end:{{ r1 + 1 }};">
                    </li>
                    {% endfor %}{% endfor %}
                </ul>
            </div>
            <div class="module-9x9-selector">
                <ul>
                    {% for r1 in ['flex-start', 'center', 'end'] %}{% for c1 in ['flex-start', 'center', 'end'] %}
                    <li>
                        <input onclick="javascript:pushStyleUpdates()" type="radio" name="group4"
                               value="--feature-align-self:{{ r1 }}; --feature-justify-self:{{ c1 }};">
                    </li>
                    {% endfor %}{% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <!-- BPM -->
    <!-- BPM -->
    <!-- BPM -->
    <div class="module bloodorange">
        <div class="title">
            <p>BPM</p>
            <button onclick="javascript:showPanelQR('#heart_embed_qrcode_dialog', 'BPM')">ðŸ”—</button>
        </div>
        <div class="preview">
            <iframe width="1920" height="1080" src="{{public_routes.PUBLIC_HEART_EMBED}}"></iframe>
        </div>
        <div class="controls">
            <div class="module-9x9-selector">
                <ul>
                    {% for r1 in [1, 2, 3] %}{% for c1 in [1, 2, 3] %}
                    <li>
                        <input onclick="javascript:pushStyleUpdates()" type="radio" name="group1"
                               value="--heart-grid-column-start:{{ c1 }}; --heart-grid-column-end:{{ c1 + 1 }};--heart-grid-row-start:{{ r1 }}; --heart-grid-row-end:{{ r1 + 1 }};">
                    </li>
                    {% endfor %}{% endfor %}
                </ul>
            </div>
            <div class="module-9x9-selector">
                <ul>
                    {% for r1 in ['flex-start', 'center', 'end'] %}{% for c1 in ['flex-start', 'center', 'end'] %}
                    <li>
                        <input onclick="javascript:pushStyleUpdates()" type="radio" name="group2"
                               value="--heart-align-self:{{ r1 }}; --heart-justify-self:{{ c1 }};">
                    </li>
                    {% endfor %}{% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block fscripts %}
<!-- dialogs start -->
{{ qrcode_dialog("heart_embed_qrcode_dialog", public_routes.PUBLIC_HEART_EMBED ) }}
{{ qrcode_dialog("feature_embed_qrcode_dialog", public_routes.PUBLIC_FEATURE_EMBED ) }}
<!-- dialogs end -->
<script>
    document.addEventListener("DOMContentLoaded", () => socketWatchReload());
    document.addEventListener("DOMContentLoaded", () => iframeDetect());
    document.addEventListener("DOMContentLoaded", () => scrollSnap('.modules'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.preview', 'width', '--js-module-preview-width'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.title', 'height', '--js-module-title-height', 'px'));
    document.addEventListener("DOMContentLoaded", () => setCssVariable('.module', 'height', '--js-module-content-height', 'px'));
    document.addEventListener("DOMContentLoaded", () => applyStyleUpdates());
</script>
{% endblock %}